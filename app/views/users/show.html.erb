
<div id='side-panel'>
  <%= render partial: "contacts" %>
</div>

<div class='container-fluid background-main fixed-height'>
  <div class="row">
    <div class='user-plate-container'>
      <%= render partial: "flashbox" %>
      <%= render partial: "user_plate" %>
    </div>
  </div>
  <div class='row'>
    <%= render partial: "user_nav" %>
  </div>
  <%= render partial: "switchable_window" %>
</div>
<%= render partial: "logbook" %>

<script>
  var userId = gon.userId;

  $(document).ready(function() {

    // auto load windows
    $('#map-tab').click(function(){
      $("#user-map-container-block").show();
      $("#tiks-container-block").hide();
      $("#badges-container-block").hide();
    });

    $("#tiks-tab").click(function(){
      $("#user-map-container-block").hide();
      $("#tiks-container-block").show();
      $("#badges-container-block").hide();
    });

    $("#badges-tab").click(function(){
      $("#user-map-container-block").hide();
      $("#tiks-container-block").hide();
      $("#badges-container-block").show();
    })

    var avatarForm = document.getElementById(`edit_user_${userId}`);

    $(avatarForm).change(function(){
      $("#avatar").append("<i class='fa fa-spinner fa-pulse fa-5x fa-fw middle-middle'></i>");
      avatarForm.submit();
    });

    // display messages if any
    var innerHTML = $('#flashbox').html();
    var iconOnly = '<i class="fa fa-exclamation-circle fa-2x" aria-hidden="true"></i>';
    if ( innerHTML.trim() !== iconOnly ) {
      $( "#flashbox-container" ).animate({
        left: '+=192px'
      }, 100);
      setTimeout(retract, 2000);
    };

    function retract(){
      $( "#flashbox-container" ).animate({
        left: '-=192px'
      }, 100);
    };

    // toggle message box
    $('flashbox-label').click(function() {
      $('#flashbox-container').toggleClass('flashbox-active');
    });

    $('#flashbox-handle').click(function() {
      $('#flashbox-container').toggleClass('flashbox-active');
    });

    $('#contacts-handle').click(function() {
      $('#contacts-container').toggleClass('contacts-active');
    });

    $('#messagebox-handle').click(function() {
      $('#messagebox-container').toggleClass('messagebox-active');
    })

    $('#contacts-header').click(function() {
      $('#contacts-container').toggleClass('contacts-active');
    })

    $('#messages-header').click(function() {
      $('#messagebox-container').toggleClass('messagebox-active');
    })

    $('.contact').hover(function() {
      $( this ).css('padding-left', '16px');
      $( this ).children(":first").css('opacity', 1);
    }, function() {
      $( this ).css('padding-left', '10px');
      $( this ).children(":first").css('opacity', 0);
    });
  });

</script>


          <!-- <h4>

          </h4>
      </section>
      <section>
        <div class="badges"><h3>BADGES</h3>
            <% @user.clear_all_badges %>
          <ul><% @user.load_badges %>
              <% @user.badges.each do |badge| %>
              <li><%= image_tag badge.image %></li>
              <% end %>
          </ul>
        </div>
      </section>
    </aside>
    <br>

  </div> -->
